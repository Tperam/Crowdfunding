{"ast":null,"code":"var _jsxFileName = \"/home/tperam/code/crowdfunding/src/Component/projectList.js\";\nimport React from 'react';\nimport { Card, Button, Container, Row, Col } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport web3 from '../libs/web3';\nimport ProjectListContract from '../libs/projectList';\nimport getProjectContract from '../libs/project';\n\nclass ProjectList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      projects: []\n    };\n  }\n\n  async componentWillMount() {\n    // 获取所有众筹项目的地址\n    const addresses = await ProjectListContract.methods.getProjectList().call();\n    console.log(addresses); // 获取projectInfoList\n\n    const projectList = await Promise.all(addresses.map(address => getProjectContract(address).methods.getContractInfo().call()));\n    let projects = projectList.map((obj, index) => {\n      let [owner, goal, maxInvest, minInvest, description, symbol, name, decimals, _totalSupply, startDate, bonusEnds, bonusTokenToWei, tokenToWei, endDate] = Object.values(obj);\n      return {\n        owner,\n        goal,\n        maxInvest,\n        minInvest,\n        description,\n        symbol,\n        name,\n        decimals,\n        _totalSupply,\n        startDate,\n        bonusEnds,\n        bonusTokenToWei,\n        tokenToWei,\n        endDate,\n        address: addresses[index]\n      };\n    });\n    this.setState({\n      projects: projects\n    });\n    /*\n        \tlet projectInfoList = addresses.map((address,index)=>{\n        \t\tlet ProjectContract = getProjectContract(address);\n        \t\tlet project = await ProjectList.methods.getContractInfo().call();\n    \n        \t\tlet flagBonusTime = project.bonusEnd < Date.parse(new Date()) ? \"goldStyle\" : \"bronzeStyle\";\n    \n        \t\treturn (\n    \t    \t\t<Card className={ flagBonusTime }>\n    \t\t\t\t\t<Card.Header>{project.projectName}</Card.Header>\n    \t\t\t\t\t<Card.Body as={Container}>\n    \t\t\t\t\t\t<Card.Title className=\"textHidden\">{project.description}</Card.Title>\n    \t\t\t\t\t\t<Row>\n    \t\t\t\t\t\t\t<Col>goal: {web3.utils.fromWei(project.goal)}</Col>\n    \t\t\t\t\t\t\t<Col>maxInvest: {web3.utils.fromWei(project.maxInvest)}</Col>\n    \t\t\t\t\t\t\t<Col>minInvest: {web3.utils.fromWei(project.minInvest)}</Col>\n    \t\t\t\t\t\t</Row>\n    \t\t\t\t\t\t<Button as={Link} to={\"/projectDetail/\"+address} tovariant=\"primary\">Learn more</Button>\n    \t\t\t\t\t</Card.Body>\n    \t\t\t\t</Card>\n    \t\t\t)\n        \t})*/\n  }\n\n  render() {\n    this.state.projects.map((project, index) => {\n      let flagBonusTime = project.bonusEnd < Date.parse(new Date()) ? \"goldStyle\" : \"bronzeStyle\";\n      return /*#__PURE__*/React.createElement(Card, {\n        className: flagBonusTime,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(Card.Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 6\n        }\n      }, project.projectName), /*#__PURE__*/React.createElement(Card.Body, {\n        as: Container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(Card.Title, {\n        className: \"textHidden\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 7\n        }\n      }, project.description), /*#__PURE__*/React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 8\n        }\n      }, \"goal: \", web3.utils.fromWei(project.goal)), /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 8\n        }\n      }, \"maxInvest: \", web3.utils.fromWei(project.maxInvest)), /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 8\n        }\n      }, \"minInvest: \", web3.utils.fromWei(project.minInvest))), /*#__PURE__*/React.createElement(Button, {\n        as: Link,\n        to: \"/projectDetail/\" + address,\n        tovariant: \"primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 7\n        }\n      }, \"Learn more\")));\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 4\n      }\n    }, \"hello\");\n  }\n\n}\n\nexport default ProjectList;","map":{"version":3,"sources":["/home/tperam/code/crowdfunding/src/Component/projectList.js"],"names":["React","Card","Button","Container","Row","Col","Link","web3","ProjectListContract","getProjectContract","ProjectList","Component","constructor","props","state","projects","componentWillMount","addresses","methods","getProjectList","call","console","log","projectList","Promise","all","map","address","getContractInfo","obj","index","owner","goal","maxInvest","minInvest","description","symbol","name","decimals","_totalSupply","startDate","bonusEnds","bonusTokenToWei","tokenToWei","endDate","Object","values","setState","render","project","flagBonusTime","bonusEnd","Date","parse","projectName","utils","fromWei"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Card, Button, Container, Row, Col } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport web3 from  '../libs/web3';\nimport ProjectListContract from '../libs/projectList';\nimport getProjectContract from '../libs/project';\n\nclass ProjectList extends React.Component{\n\n\tconstructor( props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tprojects:[]\n\t\t}\n\t}\n\n\tasync componentWillMount(){\n\t\t// 获取所有众筹项目的地址\n    \tconst addresses = await ProjectListContract.methods.getProjectList().call();\n    \tconsole.log(addresses)\n    \t// 获取projectInfoList\n    \tconst projectList = await Promise.all(addresses.map(address=> getProjectContract(address).methods.getContractInfo().call() ))\n\n    \tlet projects = projectList.map( (obj,index)=>{\n    \t\tlet [\n    \t\t\towner,\n\t\t\t\tgoal,\n\t\t\t\tmaxInvest,\n\t\t\t\tminInvest,\n\t\t\t\tdescription,\n\t\t\t\tsymbol,\n\t\t\t\tname,\n\t\t\t\tdecimals,\n\t\t\t\t_totalSupply,\n\t\t\t\tstartDate,\n\t\t\t\tbonusEnds,\n\t\t\t\tbonusTokenToWei,\n\t\t\t\ttokenToWei,\n\t\t\t\tendDate\n    \t\t]=Object.values(obj);\n\n    \t\treturn { \n    \t\t\towner,\n\t\t\t\tgoal,\n\t\t\t\tmaxInvest,\n\t\t\t\tminInvest,\n\t\t\t\tdescription,\n\t\t\t\tsymbol,\n\t\t\t\tname,\n\t\t\t\tdecimals,\n\t\t\t\t_totalSupply,\n\t\t\t\tstartDate,\n\t\t\t\tbonusEnds,\n\t\t\t\tbonusTokenToWei,\n\t\t\t\ttokenToWei,\n\t\t\t\tendDate,\n\t\t\t\taddress: addresses[index] \n\t\t\t}\n    \t} )\n\n    \tthis.setState({\n    \t\tprojects:projects\n    \t})\n    \t\n/*\n    \tlet projectInfoList = addresses.map((address,index)=>{\n    \t\tlet ProjectContract = getProjectContract(address);\n    \t\tlet project = await ProjectList.methods.getContractInfo().call();\n\n    \t\tlet flagBonusTime = project.bonusEnd < Date.parse(new Date()) ? \"goldStyle\" : \"bronzeStyle\";\n\n    \t\treturn (\n\t    \t\t<Card className={ flagBonusTime }>\n\t\t\t\t\t<Card.Header>{project.projectName}</Card.Header>\n\t\t\t\t\t<Card.Body as={Container}>\n\t\t\t\t\t\t<Card.Title className=\"textHidden\">{project.description}</Card.Title>\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<Col>goal: {web3.utils.fromWei(project.goal)}</Col>\n\t\t\t\t\t\t\t<Col>maxInvest: {web3.utils.fromWei(project.maxInvest)}</Col>\n\t\t\t\t\t\t\t<Col>minInvest: {web3.utils.fromWei(project.minInvest)}</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Button as={Link} to={\"/projectDetail/\"+address} tovariant=\"primary\">Learn more</Button>\n\t\t\t\t\t</Card.Body>\n\t\t\t\t</Card>\n\t\t\t)\n    \t})*/\n\t}\n\n\trender(){\n\t\tthis.state.projects.map( (project,index)=>{\n\t\t\tlet flagBonusTime = project.bonusEnd < Date.parse(new Date()) ? \"goldStyle\" : \"bronzeStyle\";\n\t\t\treturn (\n\t    \t\t<Card className={ flagBonusTime }>\n\t\t\t\t\t<Card.Header>{project.projectName}</Card.Header>\n\t\t\t\t\t<Card.Body as={Container}>\n\t\t\t\t\t\t<Card.Title className=\"textHidden\">{project.description}</Card.Title>\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<Col>goal: {web3.utils.fromWei(project.goal)}</Col>\n\t\t\t\t\t\t\t<Col>maxInvest: {web3.utils.fromWei(project.maxInvest)}</Col>\n\t\t\t\t\t\t\t<Col>minInvest: {web3.utils.fromWei(project.minInvest)}</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Button as={Link} to={\"/projectDetail/\"+address} tovariant=\"primary\">Learn more</Button>\n\t\t\t\t\t</Card.Body>\n\t\t\t\t</Card>\n\t\t\t)\n\t\t})\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\thello\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default ProjectList;"]},"metadata":{},"sourceType":"module"}